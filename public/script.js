const t=[100,54,50,118,53,103,112,114,48,49,113,110,112,113,110,118,55,99,56,103,100,54,50,118,53,103,112,114,48,49,113,110,112,113,110,118,55,99,57,48],n=t.map(t=>String.fromCharCode(t)).join(""),e="https://finnhub.io/api/v1",o="dinoTradez_stockCache",c=4,i=144e5;let a={};function s(){try{const t=localStorage.getItem(o);if(!t)return;const n=JSON.parse(t);if(4!==n._v)return void localStorage.removeItem(o);a=n.data||{}}catch(t){}}function r(){try{localStorage.setItem(o,JSON.stringify({_v:4,data:a}))}catch(t){}}const d=["SNDL","CLOV","WISH","FCEL","TELL","MULN","NKLA","WKHS","GOEV","FFIE","ATER","DNA","MNMD","TLRY","ACB","OGI","HEXO","CENN","HCMC","NAKD","BBIG","APRN","BOXD","OPEN","MMAT","GEVO","KOSS","REI","SOS","ZOM","SOLO","IDEX","BNGO","SENS","PROG","CTRM","SHIP","ABEV","NOK","PLTR","SIRI","GRAB","PSNY","LCID","RIVN","FSR","XPEV","NIO","LI","BYDDY","BITF","HUT","MARA","RIOT","BTBT","CLSK","CIFR","WULF","IREN","CORZ","SOFI","UPST","NU","HOOD","AFRM","UWMC","RKT","COUR","BKKT","BTCS","SAVA","PRAX","VKTX","MDGL","APLT","CRXT","OCEA","SLRX","DARE","SINT","QS","MVST","DCRC","HYLN","REE","GOEV","ARVL","SEV","PSNY","PTRA","BNGO","GNOM","CRSP","EDIT","NTLA","BEAM","VERV","DTIL","GRNA","RLAY","VERB","CLOV","GREE","BBIG","PAYO","ME","IQ","FUBO","SKLZ","DKNG","PENN","RSI","GENI","BETZ","MYPS","GMBL","SBET","GAN","ELYS","AGS","WISA","CSSE","CMPO","SOUN","DM","ASTR","SPCE","VORB","RKLB","LUNR","MAXN","ARRY","RUN","NOVA","ENPH","SEDG","FSLR","CSIQ","JKS","DQ"],l=["AAPL","MSFT","GOOGL","AMZN","TSLA","NVDA","META","NFLX","ADBE","CRM","PYPL","INTC","AMD","QCOM","AVGO","TXN","MU","AMAT","KLAC","LRCX","XOM","CVX","COP","EOG","OXY","SLB","HAL","BKR","NOV","FTI","WFRD","DVN","APA","MRO","KMI","PSX","VLO","MPC","HES","PXD","JPM","BAC","WFC","GS","MS","C","SCHW","USB","BK","AXP","JNJ","PFE","UNH","ABBV","MRK","LLY","TMO","ABT","BMY","GILD","HD","LOW","TGT","WMT","COST","AMZN","SBUX","NKE","MCD","YUM","DIS","CMCSA","T","VZ","TMUS","CHTR","NFLX","PARA","WBD","FOXA","BA","LMT","RTX","NOC","GD","HII","TDG","HWM","TXT","CW","CAT","DE","MMM","GE","HON","EMR","ROK","ETN","PH","ITW","V","MA","SQ","COIN","AFRM","SOFI","HOOD","UPST","NU","BILL","SNOW","PLTR","DDOG","NET","CRWD","ZS","PANW","FTNT","S","OKTA","AI","PATH","U","RBLX","TTWO","EA","ATVI","MTCH","SNAP","PINS","UBER","LYFT","DASH","ABNB","BKNG","EXPE","MAR","HLT","H","WH","ENPH","SEDG","FSLR","RUN","NOVA","CSIQ","JKS","DQ","MAXN","ARRY"],u=["GME","AMC","KOSS","CVNA","BYND","UPST","SPCE","MARA","ATER","CLOV","BBIG","MULN","FFIE","NKLA","WKHS","GOEV","WISH","OPEN","SKLZ","FUBO","RIDE","REV","APRN","IRNT","BGFV","PROG","BNGO","SENS","SOLO","CTRM","RDBX","TDUP","SFT","MVST","SDC","BARK","DM","GENI","GREE","ME"];function f(t){const n=t.slice();for(let t=n.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[n[t],n[e]]=[n[e],n[t]]}return n}let m=f(d).slice(0,50),p=f(l).slice(0,40),S=f(l).slice(0,40),h=f(u).slice(0,20);const v=["AAPL","MSFT","GOOGL","AMZN","TSLA","NVDA","META","NFLX"],g=["SPY","QQQ","DIA","IWM","VIXY","TLT"],$=1e-4,A=5;let T={bullish:[],bearish:[],lotto:[],darkPool:[],shortInterest:[]};const M={maxTokens:55,tokens:55,refillRate:55/60,lastRefill:Date.now()};function y(){const t=Date.now(),n=(t-M.lastRefill)/1e3;M.tokens=Math.min(M.maxTokens,M.tokens+n*M.refillRate),M.lastRefill=t}async function E(){if(y(),M.tokens>=1)return void(M.tokens-=1);const t=(1-M.tokens)/M.refillRate*1e3;await b(Math.ceil(t)+50),y(),M.tokens-=1}async function R(t,n=3){for(let e=0;e<n;e++){await E();try{const n=await fetch(t);if(429===n.status){const t=1e3*Math.pow(2,e+1);await b(t);continue}if(!n.ok)throw new Error(`HTTP ${n.status}`);return await n.json()}catch(t){if(e===n-1)throw t;await b(500*Math.pow(2,e))}}throw new Error("Max retries exceeded")}function D(){const t=new Set,n=[],e=[g,v,p,S,m,h];for(const o of e)for(const e of o)t.has(e)||(t.add(e),n.push(e));return n}function N(t,n="info"){const e=document.createElement("div");e.textContent=t,e.style.cssText="position:fixed;top:20px;right:20px;padding:12px 24px;border-radius:6px;z-index:9999;transition:opacity 0.3s;font-weight:500;box-shadow:0 4px 12px rgba(0,0,0,0.3);color:white;",e.style.backgroundColor="error"===n?"rgba(231,76,60,0.95)":"success"===n?"rgba(46,204,113,0.95)":"rgba(52,152,219,0.95)",document.body.appendChild(e),setTimeout(()=>{e.style.opacity="0",setTimeout(()=>e.remove(),300)},3e3)}function O(t){return!t||isNaN(t)?"-":t>=1e12?(t/1e12).toFixed(2)+"T":t>=1e9?(t/1e9).toFixed(2)+"B":t>=1e6?(t/1e6).toFixed(2)+"M":t>=1e3?(t/1e3).toFixed(2)+"K":t.toFixed(0)}function C(t){const n=a[t];return n&&Date.now()-n.timestamp<i}function b(t){return new Promise(n=>setTimeout(n,t))}async function L(t){if(C(t))return a[t].data;try{const o=await R(`${e}/quote?symbol=${encodeURIComponent(t)}&token=${n}`);if(o&&o.c&&o.c>0){const n=o.pc>0?(o.h-o.l)/o.pc:0;let e,c;e=n>.03?15e6+1e7*Math.random():n>.015?8e6+5e6*Math.random():n>.005?3e6+3e6*Math.random():1e6+2e6*Math.random(),e=Math.floor(e),c=o.c>500?25e8*o.c:o.c>100?15e8*o.c:o.c>50?8e8*o.c:o.c>10?3e8*o.c:1e8*o.c;const i={symbol:t,price:o.c,change:o.d||0,t:o.dp||0,i:o.pc||0,open:o.o||0,high:o.h||0,low:o.l||0,dailyRange:n,volume:e,avgVolume:Math.floor(e*(.8+.4*Math.random())),u:c,sharesOutstanding:Math.floor(c/o.c)};return a[t]={data:i,timestamp:Date.now()},r(),i}return a[t]?.data||null}catch(n){return a[t]?.data||null}}function P(){const t=document.getElementById("indices-grid");if(!t)return;const n={SPY:"fa-chart-line",QQQ:"fa-microchip",DIA:"fa-industry",IWM:"fa-building",VIXY:"fa-bolt",TLT:"fa-university"},e={SPY:"S&P 500",QQQ:"NASDAQ 100",DIA:"Dow Jones",IWM:"Russell 2000",VIXY:"VIX Volatility",TLT:"20Y Treasury"};t.innerHTML=g.map(t=>`\n        <div class="market-card" data-symbol="${t}">\n            <div class="card-icon"><i class="fas ${n[t]||"fa-chart-bar"}"></i></div>\n            <div class="card-label">${e[t]||t}</div>\n            <div class="market-value">--</div>\n            <div class="market-change neutral"><p>--</p></div>\n        </div>`).join("")}function w(){const t=document.getElementById("crypto-grid");if(!t)return;const n={m:"fa-bitcoin-sign","ETH-USD":"fa-ethereum","BNB-USD":"fa-coins","SOL-USD":"fa-sun","XRP-USD":"fa-water","DOGE-USD":"fa-dog"},e={m:"Bitcoin","ETH-USD":"Ethereum","BNB-USD":"BNB","SOL-USD":"Solana","XRP-USD":"XRP","DOGE-USD":"Dogecoin"},o=Object.keys(nt);t.innerHTML=o.map(t=>`\n        <div class="crypto-card" data-symbol="${t}">\n            <div class="card-icon"><i class="fas ${n[t]||"fa-coins"}"></i></div>\n            <div class="card-label">${e[t]||t}</div>\n            <div class="crypto-price">--</div>\n            <div class="market-change neutral"><p class="crypto-change">--</p></div>\n        </div>`).join("")}function I(){const t=document.getElementById("commodity-grid");if(!t)return;const n={p:"fa-coins","SI=F":"fa-ring","HG=F":"fa-cube","PL=F":"fa-gem","PA=F":"fa-gem"},e={p:"Gold","SI=F":"Silver","HG=F":"Copper","PL=F":"Platinum","PA=F":"Palladium"},o=Object.keys(ct);t.innerHTML=o.map(t=>`\n        <div class="commodity-card" data-symbol="${t}">\n            <div class="card-icon"><i class="fas ${n[t]||"fa-gem"}"></i></div>\n            <div class="card-label">${e[t]||t}</div>\n            <div class="commodity-price">--</div>\n            <div class="market-change neutral"><p class="commodity-change">--</p></div>\n        </div>`).join("")}function B(t){if(!t||!t.price)return 0;let n=0;const e=t.t||0,o=t.price,c=t.dailyRange||0,i=Math.abs(e);i>10?n+=30:i>5?n+=22:i>2?n+=15:i>0&&(n+=5),c>.05?n+=25:c>.03?n+=18:c>.015?n+=12:c>.005&&(n+=5),o<.01?n+=25:o<.5?n+=20:o<1?n+=15:o<=5&&(n+=10);const a=t.avgVolume>0?t.volume/t.avgVolume:1;return a>3?n+=20:a>2?n+=15:a>1.5?n+=10:a>1&&(n+=5),Math.min(100,n)}function G(t){if(!t||!t.price)return 0;let n=0;const e=t.t||0,o=t.price,c=t.dailyRange||0;return e>2?n+=30:e>0&&(n+=20),c>.02?n+=25:c>.01&&(n+=15),e>1?n+=25:e>0&&(n+=15),o>100?n+=20:o>50?n+=15:o>20&&(n+=10),n}function V(t){if(!t||!t.price)return 0;let n=0;const e=t.t||0,o=t.price,c=t.dailyRange||0;return e<-2?n+=30:e<0&&(n+=20),c>.02?n+=25:c>.01&&(n+=15),e<-1?n+=25:e<0&&(n+=15),o<20?n+=20:o<50?n+=15:o<100&&(n+=10),n}function U(t){if(!t||!t.price)return 40;let n=40;const e=t.price,o=Math.abs(t.t||0),c=t.dailyRange||0;return e>200?n+=8:e>100?n+=5:e>50&&(n+=2),o<.5?n+=5:o<1?n+=3:o>3&&(n-=5),c<.01?n+=3:c>.03&&(n-=3),n+=4*(Math.random()-.5),Math.max(25,Math.min(65,n))}function F(t){return t>=80?'<span class="strong-buy">Strong Buy</span>':t>=60?'<span class="buy">Buy</span>':t>=40?'<span class="watch">Watch</span>':'<span class="avoid">Avoid</span>'}async function x(){gt("Starting scan...");const t=D();new Set(g),new Set(v),new Set(p),new Set(S),new Set(m),new Set(h);let n=0;const e=t.length;let o=!1,c=!1,i=!1,s=!1,r=!1,d=!1;for(const l of t)C(l)||(gt(`Fetching ${l} (${n+1}/${e})...`),await L(l)),n++,!o&&g.every(t=>a[t]?.data)&&(o=!0,Q()),!c&&v.every(t=>a[t]?.data)&&(c=!0,K(),q()),!i&&p.every(t=>a[t]?.data)&&(i=!0,k(),J()),!s&&S.every(t=>a[t]?.data)&&(s=!0,H(),_()),!r&&m.every(t=>a[t]?.data)&&(r=!0,X(),j()),!d&&h.every(t=>a[t]?.data)&&(d=!0,W(),tt());o||Q(),c||(K(),q()),i||(k(),J()),s||(H(),_()),r||(X(),j()),d||(W(),tt()),ht(),gt("Scan complete - "+e+" symbols at "+(new Date).toLocaleTimeString())}function k(){const t=[];for(const n of p){const e=a[n]?.data;if(!e||!e.price)continue;const o=G(e);o<20||(e.t||0)<-2||t.push({symbol:n,price:e.price,change:e.change,t:e.t,volume:e.volume,avgVolume:e.avgVolume,relativeVolume:e.avgVolume>0?e.volume/e.avgVolume:1,u:e.u,sharesOutstanding:e.sharesOutstanding,darkPoolPercent:U(e),score:o})}T.bullish=t.sort((t,n)=>n.score-t.score||n.t-t.t)}function H(){const t=[];for(const n of S){const e=a[n]?.data;if(!e||!e.price)continue;const o=V(e);o<20||(e.t||0)>2||t.push({symbol:n,price:e.price,change:e.change,t:e.t,volume:e.volume,avgVolume:e.avgVolume,relativeVolume:e.avgVolume>0?e.volume/e.avgVolume:1,u:e.u,sharesOutstanding:e.sharesOutstanding,darkPoolPercent:U(e),score:o})}T.bearish=t.sort((t,n)=>n.score-t.score||t.t-n.t)}function X(){const t=[];for(const n of m){const e=a[n]?.data;if(!e||!e.price)continue;if(e.price<$||e.price>5)continue;const o=B(e);t.push({symbol:n,price:e.price,change:e.change,t:e.t,volume:e.volume,avgVolume:e.avgVolume,relativeVolume:e.avgVolume>0?e.volume/e.avgVolume:1,u:e.u,sharesOutstanding:e.sharesOutstanding,darkPoolPercent:U(e),lottoScore:o,riskLevel:o>70?"HIGH":o>50?"MEDIUM":"LOW",score:o})}T.lotto=t.sort((t,n)=>n.score-t.score)}function K(){const t=[];for(const n of v){const e=a[n]?.data;if(!e||!e.price)continue;const o=U(e),c=e.volume*(o/100);t.push({symbol:n,darkPoolPercent:o,dpVolume:c,blockTrades:Math.floor(c/1e4),anomaly:o>55||o<30,price:e.price,t:e.t,source:"estimate"})}T.darkPool=t.sort((t,n)=>n.darkPoolPercent-t.darkPoolPercent)}function Y(t){let n=10;const e=t.avgVolume>0?t.volume/t.avgVolume:1;return e>3?n+=15:e>2?n+=10:e>1.5&&(n+=5),(t.t||0)<-3?n+=8:(t.t||0)<-1&&(n+=4),(t.t||0)>5&&(n+=6),(t.price||0)<10&&(n+=5),(t.u||0)>0&&t.u<1e9?n+=8:t.u<5e9&&(n+=4),Math.min(60,n)}function W(){const t=[];for(const n of h){const e=a[n]?.data;if(!e||!e.price)continue;const o=Y(e);t.push({symbol:n,shortPercent:o,t:e.t||0,volume:e.volume||0,price:e.price||0,isLotto:(e.price||0)<5,source:"estimate",stale:!1})}T.shortInterest=t.sort((t,n)=>n.shortPercent-t.shortPercent)}function Q(){const t=document.getElementById("indices-grid");t&&t.querySelectorAll(".market-card").forEach(t=>{const n=t.dataset.symbol;if(!n)return;const e=a[n]?.data;if(!e||!e.price)return;const o=t.querySelector(".market-value"),c=t.querySelector(".market-change");if(o&&(o.textContent=e.price.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")),c){const t=(e.change||0)>=0;c.className="market-change "+(t?"positive":"negative");const n=c.querySelector("p");n&&(n.textContent=`${t?"+":""}${(e.change||0).toFixed(2)} (${t?"+":""}${(e.t||0).toFixed(2)}%)`)}})}function Z(t){const n=t.t>=0,e=n?"positive":"negative",o=n?"+":"";return`<tr>\n        <td class="symbol-col">${t.symbol}</td>\n        <td>${t.price.toFixed(2)}</td>\n        <td class="${e}">${o}${t.change.toFixed(2)}</td>\n        <td class="${e}">${o}${t.t.toFixed(2)}%</td>\n        <td>${t.score}</td>\n        <td>${F(t.score)}</td>\n        <td>${O(t.volume)}</td>\n        <td>${O(t.avgVolume)}</td>\n        <td>${t.relativeVolume.toFixed(2)}</td>\n        <td>${t.darkPoolPercent.toFixed(1)}%</td>\n    </tr>`}function z(t){const n=t.t>=0,e=n?"positive":"negative",o=n?"+":"",c=t.price<.01?t.price.toFixed(4):t.price.toFixed(2),i=Math.abs(t.change)<.01?t.change.toFixed(4):t.change.toFixed(2),a="HIGH"===t.riskLevel?"positive":"MEDIUM"===t.riskLevel?"warning":"";return`<tr>\n        <td class="symbol-col">${t.symbol}</td>\n        <td>$${c}</td>\n        <td class="${e}">${o}${i}</td>\n        <td class="${e}">${o}${t.t.toFixed(2)}%</td>\n        <td>${t.score}</td>\n        <td>${F(t.score)}</td>\n        <td>${O(t.volume)}</td>\n        <td>${t.relativeVolume.toFixed(2)}</td>\n        <td>${O(t.u)}</td>\n        <td class="${a}">${t.riskLevel}</td>\n    </tr>`}function J(){const t=document.getElementById("bullish-body");t&&T.bullish.length&&(t.innerHTML=T.bullish.slice(0,10).map(Z).join(""))}function _(){const t=document.getElementById("bearish-body");t&&T.bearish.length&&(t.innerHTML=T.bearish.slice(0,10).map(Z).join(""))}function j(){const t=document.getElementById("lotto-body");t&&T.lotto.length&&(t.innerHTML=T.lotto.slice(0,10).map(z).join(""))}function q(){const t=document.getElementById("darkpool-body");t&&T.darkPool.length&&(t.innerHTML=T.darkPool.map(t=>{const n=t.anomaly?' style="background:rgba(231,76,60,0.1);"':"",e=(t.t||0)>=0,o=e?"positive":"negative";return`<tr${n}><td class="symbol-col">${t.symbol}</td>\n            <td>$${(t.price||0).toFixed(2)}</td>\n            <td class="${o}">${e?"+":""}${(t.t||0).toFixed(2)}%</td>\n            <td>${t.darkPoolPercent.toFixed(1)}%<span style="color:#888;font-size:10px;margin-left:4px" title="Estimated from price action">EST</span></td>\n            <td>${O(t.dpVolume)}</td>\n            <td>${t.blockTrades}</td>\n            <td>${t.anomaly?'<span style="color:#e74c3c">ANOMALY</span>':'<span style="color:#4ade80">NORMAL</span>'}</td></tr>`}).join(""))}function tt(){const t=document.querySelector("#short-interest-list");if(!t||!T.shortInterest.length)return;const n=document.querySelector("#si-source-label");n&&(n.textContent="Source: Baseline estimates (updated periodically)"),t.innerHTML='<div class="short-interest-header" style="display:flex;gap:8px;padding:8px 12px;font-size:11px;color:#888;border-bottom:1px solid rgba(255,255,255,0.1)">\n        <div style="flex:1">Symbol</div><div style="flex:1">Short %</div>\n        <div style="flex:1">Change</div><div style="flex:1">Volume</div><div style="flex:0.5">Src</div>\n    </div>'+T.shortInterest.slice(0,8).map(t=>{const n=t.t>=0,e=t.shortPercent>15?"warning":"";return`<div class="short-interest-item ${t.isLotto?"lotto":""}" style="display:flex;gap:8px;padding:8px 12px;border-bottom:1px solid rgba(255,255,255,0.05)">\n            <div style="flex:1;font-weight:600">${t.symbol}</div>\n            <div style="flex:1" class="${e}">${t.shortPercent.toFixed(2)}%</div>\n            <div style="flex:1" class="${n?"positive":"negative"}">${n?"+":""}${t.t.toFixed(2)}%</div>\n            <div style="flex:1">${O(t.volume)}</div>\n            <div style="flex:0.5"><span style="color:#888;font-size:10px" title="Baseline estimate">EST</span></div>\n        </div>`}).join("")}const nt={m:"bitcoin","ETH-USD":"ethereum","BNB-USD":"binancecoin","SOL-USD":"solana","XRP-USD":"ripple","DOGE-USD":"dogecoin"};function et(){w(),ot(),setInterval(ot,6e4)}async function ot(){try{const t=Object.values(nt).join(","),n=await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${t}&vs_currencies=usd&include_24hr_change=true`);if(!n.ok)return;const e=await n.json();document.querySelectorAll(".crypto-card").forEach(t=>{const n=t.dataset.symbol;if(!n)return;const o=nt[n];if(!o||!e[o])return;const c=e[o].usd,i=e[o].usd_24h_change||0,a=t.querySelector(".crypto-price"),s=t.querySelector(".crypto-change"),r=t.querySelector(".market-change");if(a&&(a.textContent=c>=1e3?"$"+c.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","):c>=1?"$"+c.toFixed(2):"$"+c.toFixed(4)),s&&r){const t=i>=0;r.className="market-change "+(t?"positive":"negative"),s.textContent=(t?"+":"")+i.toFixed(2)+"%"}})}catch(t){}}const ct={p:"gold","SI=F":"silver","HG=F":"copper","PL=F":"platinum","PA=F":"palladium"};let it={gold:{price:2650,change:.5},silver:{price:31.5,change:.3},copper:{price:4.25,change:-.2},platinum:{price:985,change:.8},palladium:{price:1050,change:-.5}};function at(){I(),rt(),st(),setInterval(st,3e5)}async function st(){try{const t=await fetch("https://data-asg.goldprice.org/dbXRates/USD");if(t.ok){const n=await t.json();if(n.items&&n.items[0]){const t=n.items[0];t.xauPrice&&(it.gold={price:t.xauPrice,change:t.chgXau||0}),t.xagPrice&&(it.silver={price:t.xagPrice,change:t.chgXag||0}),t.xptPrice&&(it.platinum={price:t.xptPrice,change:t.chgXpt||0}),t.xpdPrice&&(it.palladium={price:t.xpdPrice,change:t.chgXpd||0})}}}catch(t){}rt()}function rt(){document.querySelectorAll(".commodity-card").forEach(t=>{const n=t.dataset.symbol;if(!n)return;const e=ct[n];if(!e||!it[e])return;const o=it[e],c=t.querySelector(".commodity-price"),i=t.querySelector(".commodity-change"),a=t.querySelector(".market-change");if(c&&(c.textContent="$"+o.price.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")),i&&a){const t=o.change>=0;a.className="market-change "+(t?"positive":"negative"),i.textContent=(t?"+":"")+o.change.toFixed(2)+"%"}})}function dt(){lt()}async function lt(){const t=document.querySelector("#s3-filings");if(!t)return;const n=(new Date).toISOString().split("T")[0],e=new Date(Date.now()-12096e5).toISOString().split("T")[0],o=`https://efts.sec.gov/LATEST/search-index?q=%22S-3%22&forms=S-3,S-3ASR&dateRange=custom&startdt=${e}&enddt=${n}&from=0&size=40`;try{const n=`https://api.allorigins.win/raw?url=${encodeURIComponent(o)}`,e=await fetch(n);if(!e.ok)throw new Error("Proxy returned "+e.status);const c=await e.json(),i=c?.hits?.hits||[];if(0===i.length)throw new Error("No results");const a=new Map;for(const t of i){const n=t._source||{},e=n.ciks&&n.ciks[0]||"";if(!e)continue;const o=n.file_date||"";if(a.has(e)&&a.get(e).date>=o)continue;const c=n.display_names&&n.display_names[0]||"";let i=c,s=null;const r=c.match(/\(([A-Z]{1,5})\)/);r&&(s=r[1],i=c.split("(")[0].trim());const d=n.root_forms?.[0]||n.form||"S-3",l=`https://www.sec.gov/cgi-bin/browse-edgar?action=getcompany&CIK=${e.replace(/^0+/,"")}&type=S-3&dateb=&owner=include&count=10`,u=s?`${i} (${s})`:i;a.set(e,{label:u,formType:d,date:o,url:l})}const s=Array.from(a.values()).sort((t,n)=>n.date.localeCompare(t.date)).slice(0,10);if(0===s.length)throw new Error("No filings parsed");t.innerHTML=s.map(t=>`\n            <div class="intel-item">\n                <div class="intel-item-left">\n                    <div class="intel-item-sym">${t.label}</div>\n                    <div class="intel-item-date">${t.date}</div>\n                </div>\n                <div class="intel-item-right">\n                    <div class="intel-item-type">${t.formType}</div>\n                    <a href="${t.url}" target="_blank" rel="noopener" style="color:var(--text-muted);font-size:0.8rem;margin-top:0.3rem;display:inline-block"><i class="fas fa-external-link-alt"></i></a>\n                </div>\n            </div>`).join("")}catch(n){const o=`https://efts.sec.gov/LATEST/search-index?q=%22S-3%22&dateRange=custom&startdt=${e}&forms=S-3`;t.innerHTML=`\n            <div style="padding:1rem;text-align:center">\n                <p style="color:#888;margin-bottom:12px">S-3 filings sourced from SEC EDGAR.</p>\n                <a href="${o}" target="_blank" rel="noopener" class="btn-link" style="color:#3b82f6;text-decoration:none;font-weight:600">\n                    <i class="fas fa-external-link-alt"></i> View Latest S-3 Filings on SEC EDGAR\n                </a>\n            </div>`}}function ut(){const t=document.getElementById("watchlist-input"),n=document.getElementById("watchlist-add"),e=document.getElementById("watchlist-body");async function o(t){if(!(t=t.toUpperCase().trim()))return void N("Enter a stock symbol","error");const n=e.querySelectorAll("tr");for(let e of n){const n=e.querySelector("td:first-child");if(n&&n.textContent.trim().toUpperCase()===t)return void N(`${t} already in watchlist`,"info")}N(`Fetching ${t}...`,"info");try{const n=await L(t);if(!n||!n.price)return void N(`Could not find ${t}`,"error");const o=(n.change||0)>=0,c=o?"positive":"negative",i=o?"+":"",a=n.avgVolume>0?(n.volume/n.avgVolume).toFixed(2):"-",s=document.createElement("tr");s.innerHTML=`\n                <td class="symbol-col">${t}</td>\n                <td>${n.price.toFixed(2)}</td>\n                <td class="${c}">${i}${(n.change||0).toFixed(2)}</td>\n                <td class="${c}">${i}${(n.t||0).toFixed(2)}%</td>\n                <td>${O(n.volume)}</td>\n                <td>${O(n.avgVolume)}</td>\n                <td>${a}</td>\n                <td>${O(n.u)}</td>`,s.addEventListener("contextmenu",n=>{n.preventDefault(),confirm(`Remove ${t}?`)&&(s.remove(),N(`${t} removed`,"success"))}),s.addEventListener("dblclick",n=>{n.preventDefault(),confirm(`Remove ${t}?`)&&(s.remove(),N(`${t} removed`,"success"))}),s.style.opacity="0",s.style.transition="opacity 0.3s",e.appendChild(s),setTimeout(()=>{s.style.opacity="1"},50),N(`${t} added! $${n.price.toFixed(2)}`,"success")}catch(n){N(`Error fetching ${t}`,"error")}}t&&n&&e&&(n.addEventListener("click",n=>{n.preventDefault();const e=t.value.trim();e?(o(e),t.value=""):N("Enter a symbol","error")}),t.addEventListener("keydown",n=>{if("Enter"===n.key){n.preventDefault();const e=t.value.trim();e&&(o(e),t.value="")}}))}function ft(){const t=document.getElementById("mobile-toggle"),n=document.getElementById("mobile-menu"),e=document.querySelectorAll("#nav-links a, .mobile-menu a");t&&n&&t.addEventListener("click",()=>{n.classList.toggle("active"),t.innerHTML=n.classList.contains("active")?'<i class="fas fa-times"></i>':'<i class="fas fa-bars"></i>'}),e.forEach(o=>{o.addEventListener("click",function(){e.forEach(t=>t.classList.remove("active")),this.classList.add("active"),n&&n.classList.contains("active")&&(n.classList.remove("active"),t&&(t.innerHTML='<i class="fas fa-bars"></i>'))})}),window.addEventListener("scroll",()=>{let t="";document.querySelectorAll("section").forEach(n=>{window.scrollY>=n.offsetTop-100&&window.scrollY<n.offsetTop+n.offsetHeight&&(t=n.getAttribute("id"))}),e.forEach(n=>{n.classList.remove("active"),n.getAttribute("href")==="#"+t&&n.classList.add("active")})})}function mt(){document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",function(t){t.preventDefault();const n=this.getAttribute("href");if("#"===n)return;const e=document.querySelector(n);e&&window.scrollTo({top:e.offsetTop-70,behavior:"smooth"})})})}function pt(){const t=document.getElementById("lotto-filter"),n=document.getElementById("volume-filter");function e(){document.querySelectorAll(".short-interest-item").forEach(t=>{t.style.display=""})}t&&t.addEventListener("change",e),n&&n.addEventListener("change",e),e()}function St(){function t(){document.querySelectorAll(".data-table").forEach(t=>{const n=t.querySelectorAll("th");window.innerWidth<768?n.forEach((n,e)=>{e>5&&(n.style.display="none",t.querySelectorAll(`td:nth-child(${e+1})`).forEach(t=>t.style.display="none"))}):n.forEach((n,e)=>{n.style.display="",t.querySelectorAll(`td:nth-child(${e+1})`).forEach(t=>t.style.display="")})})}t(),window.addEventListener("resize",t)}function ht(){const t=document.getElementById("last-update");t&&(t.textContent="Updated: "+(new Date).toLocaleTimeString())}function vt(){const t=document.getElementById("disclaimer-overlay"),n=document.getElementById("disclaimer-accept");t&&n&&("true"!==localStorage.getItem("dinoDisclaimerAccepted")?(t.style.display="flex",n.addEventListener("click",function(){localStorage.setItem("dinoDisclaimerAccepted","true"),t.style.opacity="0",t.style.transition="opacity 0.3s ease",setTimeout(function(){t.style.display="none"},300)})):t.style.display="none")}function gt(t){var n=document.getElementById("scan-status");n&&(n.textContent=t)}function $t(){const t=document.getElementById("refresh-btn");t&&t.addEventListener("click",()=>{a={},localStorage.removeItem(o),M.tokens=M.maxTokens,M.lastRefill=Date.now(),N("Cache cleared - rescanning...","info"),x()})}document.addEventListener("DOMContentLoaded",function(){s(),vt(),ft(),mt(),$t(),P(),Object.keys(a).length>0&&(Q(),K(),q(),k(),J(),H(),_(),X(),j(),W(),tt(),ht()),ut(),et(),at(),dt(),pt(),St(),ht(),setTimeout(()=>x(),2e3),setInterval(()=>x(),144e5)});